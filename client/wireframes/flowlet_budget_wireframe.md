# FLOWLET 予算設定画面 ワイヤーフレーム

## 1. PC版レイアウト

```
┌─────────────────────────────────────────────────────────────────────┐
│ FLOWLET                                    [ユーザー名] [設定] [⚙]  │
├──────────┬──────────────────────────────────────────────────────────┤
│          │                                                          │
│ ナビゲー  │  ┌─────────────────────────────────────────────────┐   │
│ ション   │  │ 予算設定                                         │   │
│          │  └─────────────────────────────────────────────────┘   │
│ 🏠 ホーム │                                                          │
│          │  ┌──────────────────────────────────────────────────┐  │
│ 💰 取引   │  │ サイクル選択                                      │  │
│  - 入力  │  │ [← 前のサイクル]  2024/01/25 - 2024/02/24  [次 →]│  │
│  - 履歴  │  └──────────────────────────────────────────────────┘  │
│          │                                                          │
│ 📊 予算   │  ┌──────────────────────────────────────────────────┐  │
│          │  │ 全体予算                            [編集] [削除]  │  │
│ 🎯 貯金   │  │                                                  │  │
│          │  │ 予算額: ¥200,000                                 │  │
│ 🏦 口座   │  │ 使用額: ¥120,000                                 │  │
│ カード   │  │ 残額: ¥80,000                                    │  │
│          │  │ 使用率: ━━━━━━━━━━━━━━━━━━━ 60%              │  │
│ 📁 カテゴリ│  └──────────────────────────────────────────────────┘  │
│          │                                                          │
│ 🔄 繰返支出│  カテゴリ別予算                    [+ カテゴリ予算追加] │
│          │                                                          │
│ 📈 レポート│  ┌──────────────────────────────────────────────────┐  │
│          │  │ 食費                                [編集] [削除]  │  │
│ ⚙ 設定    │  │                                                  │  │
│          │  │ 予算額: ¥50,000                                  │  │
│          │  │ 使用額: ¥35,000                                  │  │
│          │  │ 残額: ¥15,000                                    │  │
│          │  │ 使用率: ━━━━━━━━━━━━━━ 70%                    │  │
│          │  │                                                  │  │
│          │  │ 小カテゴリ:                                      │  │
│          │  │   食料品  ¥30,000 (¥20,000使用) ━━━━━━━ 66.7%  │  │
│          │  │   外食    ¥20,000 (¥15,000使用) ━━━━━━━━ 75%   │  │
│          │  └──────────────────────────────────────────────────┘  │
│          │                                                          │
│          │  ┌──────────────────────────────────────────────────┐  │
│          │  │ 交通費                              [編集] [削除]  │  │
│          │  │                                                  │  │
│          │  │ 予算額: ¥15,000                                  │  │
│          │  │ 使用額: ¥8,000                                   │  │
│          │  │ 残額: ¥7,000                                     │  │
│          │  │ 使用率: ━━━━━━━━━━ 53.3%                      │  │
│          │  └──────────────────────────────────────────────────┘  │
│          │                                                          │
│          │  ┌──────────────────────────────────────────────────┐  │
│          │  │ 住居費                              [編集] [削除]  │  │
│          │  │                                                  │  │
│          │  │ 予算額: ¥80,000                                  │  │
│          │  │ 使用額: ¥80,000                                  │  │
│          │  │ 残額: ¥0                                         │  │
│          │  │ 使用率: ━━━━━━━━━━━━━━━━━━━━ 100%            │  │
│          │  └──────────────────────────────────────────────────┘  │
│          │                                                          │
└──────────┴──────────────────────────────────────────────────────────┘
```

---

## 2. 予算編集モーダル(PC版)

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│     ┌───────────────────────────────────────────────────┐           │
│     │ 予算編集                                  [× 閉じる]│           │
│     ├───────────────────────────────────────────────────┤           │
│     │                                                   │           │
│     │ ┌─────────────────────────────────────────────┐  │           │
│     │ │ サイクル期間                                │  │           │
│     │ │ 2024/01/25 - 2024/02/24                     │  │           │
│     │ └─────────────────────────────────────────────┘  │           │
│     │                                                   │           │
│     │ ┌─────────────────────────────────────────────┐  │           │
│     │ │ カテゴリ                                    │  │           │
│     │ │ [食費 ▼]                                    │  │           │
│     │ └─────────────────────────────────────────────┘  │           │
│     │                                                   │           │
│     │ ┌─────────────────────────────────────────────┐  │           │
│     │ │ 小カテゴリも設定しますか?                   │  │           │
│     │ │ ☑ 小カテゴリごとに予算を設定               │  │           │
│     │ └─────────────────────────────────────────────┘  │           │
│     │                                                   │           │
│     │ ┌─────────────────────────────────────────────┐  │           │
│     │ │ 大カテゴリ予算額                            │  │           │
│     │ │ ¥ [50,000]                                  │  │           │
│     │ └─────────────────────────────────────────────┘  │           │
│     │                                                   │           │
│     │ 小カテゴリ予算:                                   │           │
│     │ ┌─────────────────────────────────────────────┐  │           │
│     │ │ 食料品  ¥ [30,000]                          │  │           │
│     │ └─────────────────────────────────────────────┘  │           │
│     │ ┌─────────────────────────────────────────────┐  │           │
│     │ │ 外食    ¥ [20,000]                          │  │           │
│     │ └─────────────────────────────────────────────┘  │           │
│     │                                                   │           │
│     │ 小カテゴリ合計: ¥50,000 / 大カテゴリ: ¥50,000 ✓ │           │
│     │                                                   │           │
│     │ ┌─────────────────────────────────────────────┐  │           │
│     │ │         [キャンセル]     [保存する]        │  │           │
│     │ └─────────────────────────────────────────────┘  │           │
│     │                                                   │           │
│     └───────────────────────────────────────────────────┘           │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 3. スマホ版レイアウト

```
┌─────────────────────────┐
│ ← 予算設定              │
├─────────────────────────┤
│                         │
│ サイクル選択            │
│ [← 前]  2024/01/25 -   │
│       2024/02/24  [次→] │
│                         │
│ ┌─────────────────────┐ │
│ │ 全体予算     [編集] │ │
│ │                     │ │
│ │ 予算: ¥200,000      │ │
│ │ 使用: ¥120,000      │ │
│ │ 残額: ¥80,000       │ │
│ │ ━━━━━━━━━━━━ 60%  │ │
│ └─────────────────────┘ │
│                         │
│ カテゴリ別予算          │
│          [+ カテゴリ追加]│
│                         │
│ ┌─────────────────────┐ │
│ │ 食費         [編集] │ │
│ │                     │ │
│ │ 予算: ¥50,000       │ │
│ │ 使用: ¥35,000       │ │
│ │ 残額: ¥15,000       │ │
│ │ ━━━━━━━━━━ 70%    │ │
│ │                     │ │
│ │ 小カテゴリ:         │ │
│ │ • 食料品 ¥30,000    │ │
│ │   (¥20,000使用)     │ │
│ │   ━━━━━━ 66.7%    │ │
│ │ • 外食 ¥20,000      │ │
│ │   (¥15,000使用)     │ │
│ │   ━━━━━━━ 75%    │ │
│ └─────────────────────┘ │
│                         │
│ ┌─────────────────────┐ │
│ │ 交通費       [編集] │ │
│ │                     │ │
│ │ 予算: ¥15,000       │ │
│ │ 使用: ¥8,000        │ │
│ │ 残額: ¥7,000        │ │
│ │ ━━━━━━━ 53.3%     │ │
│ └─────────────────────┘ │
│                         │
│ ┌─────────────────────┐ │
│ │ 住居費       [編集] │ │
│ │                     │ │
│ │ 予算: ¥80,000       │ │
│ │ 使用: ¥80,000       │ │
│ │ 残額: ¥0            │ │
│ │ ━━━━━━━━━━ 100%  │ │
│ └─────────────────────┘ │
│                         │
└─────────────────────────┘
```

---

## 4. 予算編集画面(スマホ版)

```
┌─────────────────────────┐
│ ← 予算編集              │
├─────────────────────────┤
│                         │
│ サイクル期間            │
│ ┌─────────────────────┐ │
│ │ 2024/01/25 -        │ │
│ │ 2024/02/24          │ │
│ └─────────────────────┘ │
│                         │
│ カテゴリ                │
│ ┌─────────────────────┐ │
│ │ 食費 ▼              │ │
│ └─────────────────────┘ │
│                         │
│ 大カテゴリ予算額        │
│ ┌─────────────────────┐ │
│ │ ¥ _____________     │ │
│ └─────────────────────┘ │
│                         │
│ ☑ 小カテゴリごとに     │
│   予算を設定            │
│                         │
│ 小カテゴリ予算:         │
│                         │
│ 食料品                  │
│ ┌─────────────────────┐ │
│ │ ¥ _____________     │ │
│ └─────────────────────┘ │
│                         │
│ 外食                    │
│ ┌─────────────────────┐ │
│ │ ¥ _____________     │ │
│ └─────────────────────┘ │
│                         │
│ 小カテゴリ合計:         │
│ ¥50,000 / ¥50,000  ✓   │
│                         │
│ ┌─────────────────────┐ │
│ │   [キャンセル]      │ │
│ └─────────────────────┘ │
│ ┌─────────────────────┐ │
│ │   [保存する]        │ │
│ └─────────────────────┘ │
│                         │
└─────────────────────────┘
```

---

## 5. UI仕様

### サイクル選択
- 前後のサイクルに移動可能
- デフォルト: 現在のサイクル
- 未来のサイクルにも移動可能(先に予算設定)

### 全体予算
- 必須ではない
- 設定しない場合は表示なし
- カテゴリ予算の合計と比較表示(オプション)

### カテゴリ別予算
- 大カテゴリのみ設定可能
- または大カテゴリ+小カテゴリの両方設定
- 小カテゴリ予算の合計が大カテゴリ予算と一致するかバリデーション

### プログレスバー色分け
- 0-60%: 緑色
- 60-80%: 黄色
- 80-99%: オレンジ色
- 100%以上: 赤色

### 使用額の計算
- API: フィルター条件で当該サイクル+カテゴリの支出を集計
- リアルタイムで更新

---

## 6. 機能詳細

### 予算一覧取得
- API: `GET /api/budgets?cycleStartDate=2024-01-25`
- または `GET /api/budgets/current` (現在のサイクル)

### 予算作成
- API: `POST /api/budgets`
- サイクル期間は自動で設定(給料日から計算)
- 全体予算: `categoryId = null`
- カテゴリ別: `categoryId` を指定

### 予算更新
- API: `PUT /api/budgets/{budgetId}`
- 予算額のみ更新可能

### 予算削除
- API: `DELETE /api/budgets/{budgetId}`
- 確認ダイアログ表示

### カテゴリ追加
- カテゴリ一覧から選択
- 既に予算設定済みのカテゴリは選択不可
- 複数の小カテゴリを一度に設定可能

---

## 7. バリデーション

### 予算額
- 必須
- 0より大きい数値

### 小カテゴリ予算
- 小カテゴリ予算の合計 = 大カテゴリ予算
- 一致しない場合はエラー表示
- 警告アイコンと「合計が一致しません」メッセージ

### 重複チェック
- 同じサイクル・同じカテゴリの予算は1つのみ

---

## 8. インタラクション

### PC版
- カード全体がホバーでハイライト
- [編集]ボタン: モーダル表示
- [削除]ボタン: 確認ダイアログ

### スマホ版
- カードタップ: 詳細表示(展開/折りたたみ)
- [編集]ボタン: 編集画面へ遷移
- スワイプアクション: 削除(オプション)

---

## 9. エッジケース

### 予算未設定の場合
```
┌─────────────────────────┐
│                         │
│    📊                   │
│                         │
│  まだ予算が設定されて    │
│  いません               │
│                         │
│  [全体予算を設定]       │
│  [カテゴリ予算を設定]   │
│                         │
└─────────────────────────┘
```

### 予算超過の場合
- プログレスバーが赤色
- 「予算超過: +¥5,000」のように表示
- 使用率が100%以上(例: 125%)

---

このワイヤーフレームで問題ないですか?

次は**口座・カード管理画面**を作成しますね!