# Phase 1 MVP ユースケース定義

## 目的

FLOWLET Phase 1 では、以下を満たすことをゴールとする。

- 収入・支出・振替を記録できる
- 口座残高を正しく把握できる
- 一部口座において目的別にお金を管理できる
- 今月の収支を確認できる

---

## 前提ルール

- 金額はすべて正の値（円）
- 残高計算ルール  
  - from：減算  
  - to：加算
- 目的（Purpose）は口座に紐づく
- 目的別管理は一部口座のみ有効

---

## ユースケース一覧

### UC-01：収入を登録する

#### 概要
給与や臨時収入など、口座にお金が入る取引を登録する。

#### 入力情報
- 取引種別：INCOME
- 金額
- 入金先口座
- （任意）入金先目的
- メモ
- 取引日
- 収支計算対象フラグ（通常は true）

#### 業務ルール
- from は常に NULL
- to は必須
- toPurpose は目的別管理有効口座のみ指定可能

#### 結果
- 口座残高が増加する
- 今月の収入に加算される

---

### UC-02：支出を登録する

#### 概要
生活費や買い物など、口座からお金を使う取引を登録する。

#### 入力情報
- 取引種別：EXPENSE
- 金額
- 出金元口座
- （任意）出金元目的
- メモ
- 取引日
- 収支計算対象フラグ（通常は true）

#### 業務ルール
- to は常に NULL
- from は必須
- fromPurpose は目的別管理有効口座のみ指定可能

#### 結果
- 口座残高が減少する
- 今月の支出に加算される

---

### UC-03：振替を登録する

#### 概要
口座間、または同一口座内（目的間）でお金を移動する。

#### 入力情報
- 取引種別：TRANSFER
- 金額
- 振替元口座
- （任意）振替元目的
- 振替先口座
- （任意）振替先目的
- メモ
- 取引日

#### 業務ルール
- from / to は必須
- isIncomeExpenseTarget は false 固定
- 同一口座内の目的間振替も可

#### 結果
- 残高合計は変わらない
- 収支には影響しない

---

### UC-04：今月の収支を確認する

#### 概要
指定した月の収入・支出・差額を確認する。

#### 表示内容
- 月間収入合計
- 月間支出合計
- 収支差額

#### 集計条件
- transactionType：INCOME / EXPENSE
- isIncomeExpenseTarget = true
- occurredAt が指定月内

---

### UC-05：口座残高を確認する

#### 概要
現在の口座残高を確認する。

#### 計算ルール
口座残高 =
初期残高
	+	Σ(to_account の取引金額)
	-	Σ(from_account の取引金額)

#### 備考
- 収入・支出・振替すべて対象
- isIncomeExpenseTarget は無関係

---

### UC-06：目的別残高を確認する（目的別管理口座のみ）

#### 概要
口座内の各目的ごとの残高を確認する。

#### 計算ルール
目的残高 =
割当金額
	+ Σ(to_purpose の取引金額)
	-	Σ(from_purpose の取引金額)

---

## Phase 1 でやらないこと

- クレジットカード管理
- 投資・評価額管理
- 自動連携（銀行API等）
- ユーザー・認証管理
- 複数通貨対応

---

## このドキュメントの役割

- MVP要件の確定資料
- DB設計の妥当性確認
- UI / API 設計の入力資料
- 技術スタック選定時の判断軸
